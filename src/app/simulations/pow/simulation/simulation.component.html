<div class="content">
    <div class="items">
        <div class="text">
            <mat-expansion-panel expanded="false">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        <h2>Input</h2>
                    </mat-panel-title>
                </mat-expansion-panel-header>
                <div class="parameters">
                    <span>
                        Auftrittswahrscheinlichkeit: 1 / (Hashrate im Netzwerk * Blockzeit)
                    </span>
                    <button mat-button (click)="determineHashRate()" [disabled]="isCalculating">
                        Hashrate ermitteln
                    </button>
                    <mat-form-field appearance="fill">
                        <mat-label>Hashrate [Hashes pro Sekunde]</mat-label>
                        <input type="number" matInput [(ngModel)]="hashRate" [min]="minHashRate" [max]="maxHashRate"
                            step="1" [readonly]="isCalculating">
                    </mat-form-field>
                    <mat-form-field appearance="fill">
                        <mat-label>externe Hashrate [Hashes pro Sekunde]</mat-label>
                        <input type="number" matInput [(ngModel)]="externalHashRate" min="0" step="1">
                    </mat-form-field>
                    <mat-form-field appearance="fill">
                        <mat-label>Blockzeit [in Sekunden]</mat-label>
                        <input type="number" matInput [(ngModel)]="blockTime" min="1" max="600" step="1">
                    </mat-form-field>
                </div>
                <mat-expansion-panel expanded="false">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            <h3>Berechungen</h3>
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div class="calculations">
                        <p>
                            <mat-label>Wahrscheinlichkeit [für richtigen Block]</mat-label><br />
                            <span> = {{probability}}</span>
                        </p>
                        <p>
                            <mat-label>Anzahl Blöcke [zu finden - nach Wahrscheinlichkeit]</mat-label><br />
                            <span> = {{expectedAmountOfBlocks}}</span>
                        </p>
                        <p>
                            <mat-label>Anzahl HashRates [zu finden - nach Wahrscheinlichkeit]</mat-label><br />
                            <span> = {{expectedAmountOfHashrates}}</span>
                        </p>
                        <p>
                            <mat-label>Erwartete Hash Präfixe</mat-label><br />
                            <span> = {{expectedPrefixes}}</span>
                        </p>
                        <p>
                            <mat-label>Hexadezimale Formel</mat-label><br />
                            <span> = {{hexaDecimalFormula}}</span>
                        </p>
                    </div>
                </mat-expansion-panel>
            </mat-expansion-panel>

            <mat-expansion-panel>
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        <h2>Optionen</h2>
                    </mat-panel-title>
                </mat-expansion-panel-header>
                <div class="options">
                    <mat-form-field apperance="fill">
                        <mat-label>Anzahl angezeigter Hashes</mat-label>
                        <input type="number" matInput [(ngModel)]="amountHashesToShow" [min]="minAmountOfHashesToShow"
                            step="1" [max]="maxAmountOfHashesToShow">
                    </mat-form-field>
                    <mat-checkbox [(ngModel)]="stopOnFoundBlock">
                        Stoppen bei gefundenem Block
                    </mat-checkbox>

                    <mat-checkbox [(ngModel)]="clearOnStart">
                        Clear bei Start
                    </mat-checkbox>
                </div>
            </mat-expansion-panel>

            <div class="actions">
                <button mat-button (click)="start()" [disabled]="isProcessing || isCalculating">Start</button>
                <button mat-button (click)="stop()" [disabled]="!isProcessing || isCalculating">Stop</button>
                <button mat-button (click)="clear()"
                    [disabled]="isProcessing || hashes.length === 0 || isCalculating">Clear</button>
                <div *ngIf="isProcessing || hashes.length > 0">
                    <span>
                        Simulation {{isProcessing ? 'gestartet...' : 'beendet.'}}<br />
                        Ausgeführte eigene Hashraten: {{executedHashrates}}<br />
                        Anzahl eigener Hashes: {{hashNo}}<br />
                    </span>
                    <mat-progress-bar [mode]="isProcessing ? 'indeterminate' : 'determinate'">
                    </mat-progress-bar>
                </div>
                <div *ngIf="!isProcessing && hashes.length == 0">
                    <span>
                        Bereit für Simulation.
                    </span>
                    <mat-progress-bar [mode]="isProcessing ? 'indeterminate' : 'determinate'">
                    </mat-progress-bar>
                </div>
            </div>
        </div>

        <div class="simulation">
            <div class="header">
                <img src="assets/bitcoin-btc-logo.svg">
                <span>
                    Proof of Work Simulation
                </span>
            </div>
            <div class="data">
                <span>> {{header}}</span>
                <span>> {{headerLine}}</span>
                <span *ngFor="let hash of hashes">
                    > <span *ngFor="let col of columns">{{columnValue(hash, col)}}</span>
                </span>
                <span>> <span *ngIf="blink">...</span></span>
            </div>
        </div>

    </div>
</div>